<!DOCTYPE html>
<html>
<head>
    <title>Air Quality Monitoring</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
</head>

<body>
	<nav class="navbar navbar-default">
    	<div class="container-fluid">
        	<div class="navbar-header">
      			<a class="navbar-brand" href="#">Air Quality Monitor</a>
    		</div>
        	<ul class="nav navbar-nav">
            	<li class="active"><a href="#">Home</a></li>
      			<li><a href="#">Page 1</a></li>
      			<li><a href="#">Page 2</a></li>
      			<li><a href="#">Page 3</a></li>
    		</ul>
 		 </div>
	</nav>
     
    <div style="margin-left:2em">  
		  <h3>You've connected to peer {{peer_num}}</h3>
    </div>
    <div style="margin-left:2em">
      <p>Choose your city</p>
		  <select name="Area" id="area">
    		<option value="newyork">New York</option>
		    <option value="camden">Camden</option>
        <option value="newark">Newark</option>
        <option value="holtsville">Holtsville</option>
		  </select>
	</div>
  <canvas id="myChart" width="500" height="500"></canvas>

  <script>
    var ctx = document.getElementById('myChart').getContext('2d');

    var myChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: {{time}},
            datasets: [
              {
                label: 'NO2',
                data : {{aqualities}},
                backgroundColor:['rgba(54, 162, 235, 0.2)'],
                borderColor: ['rgba(54, 162, 235, 1)'],
                borderWidth: 1
              }
            ]
        },
        options: {
        scales: { yAxes: [{ ticks: { beginAtZero: false }}] },
        responsive: false
      }
  });

    setInterval(function(){
      $.ajax({
        url:'/home/update_chart',
        success: function(test){
          myChart.data.datasets[0].data = test.aqualities;
          myChart.data.labels = test.time;
          myChart.update();
        }
      });
    }, 5000);
  </script>
</body>
</html>